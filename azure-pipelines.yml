name: Playwright Tests
trigger:
  - main
  - master
jobs:
  - job: test    
    pool:
      vmImage: "windows-2019"
    steps:
      - task: NodeTool@0
        inputs:
          versionSpec: "16.x"
        displayName: "Install Node.js"
      - script: |
          npm ci
        displayName: "Install dependencies"
      - script: |
          npx playwright install --with-deps
        displayName: "Install Playwright Browsers"
      - script: |
          npx playwright test          
          displayName: "Run Playwright tests"     
      -   publish: $(System.DefaultWorkingDirectory)
          artifact: drop      
          options: test -./result.xml
      - script: npx test-results-reporter publish -c ./report.json
        displayName: Reporting Results
        # always create the artifact, this is useful for debugging failed tests

        continueOnError: true      
        condition: always()